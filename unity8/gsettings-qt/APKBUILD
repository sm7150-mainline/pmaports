# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=gsettings-qt
pkgver=0_git20171026
_commit="3b03880cc40675541d330681e55e0e9787dce99d"
pkgrel=0
pkgdesc="Library to access GSettings from Qt"
url="https://github.com/ubports/gsettings-qt"
arch="x86_64"
license="LGPL-3.0"
depends=""
depends_dev="qt5-qtdeclarative-dev"
makedepends="$depends_dev qt5-qtbase-dev"
subpackages="$pkgname-dev"
source="$pkgname-$_commit.tar.gz::https://github.com/ubports/$pkgname/archive/$_commit.tar.gz
	fix_install.patch"
builddir="$srcdir/$pkgname-$_commit"
options="!check" # Requires running X11 server

build() {
	cd "$builddir"
	qmake-qt5
	make -j1 # See https://github.com/ubports/gsettings-qt/issues/2
}

check() {
	cd "$builddir"
	make check
}

package() {
	cd "$builddir"
	make INSTALL_ROOT="$pkgdir" install
}

sha512sums="6f0e7522da13ec3f07f2a23458eaab179ff778d367b224b3e648b2a60d4986b2b8b5016ff5fa1fda11c92dc64e8ae5aef40c7b9a72bdbce32fea2786bd007ac8  gsettings-qt-3b03880cc40675541d330681e55e0e9787dce99d.tar.gz
de1dd50997868c67742a23909b3682068e7262991df6f0e27dfd0f2774de26dc07f524f1a0fe335b93ee8044b78ee42e9af8d9a38c03f9cf073e361f6f6c2b08  fix_install.patch"
